<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WAVER 3 | DEAD OR ALIVE</title>
  <meta name="description" content="WAVER 3 ティザーサイト。黒背景、ロゴ画像挿入、イントロ→フェードアウト、弾痕演出、火の粉（embers）＆スモーク、NEWS→STORY→CAST→STAFF→GALLERY→WAVER2音声。" />
  <style>
    :root{ --accent:#e50914; --ink:#e5e7eb; --line:#23232b; }
    html,body{margin:0;padding:0;background:#000;color:#fff;font-family:"Noto Sans JP",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Yu Gothic"}
    img{max-width:100%;height:auto;display:block}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:1200px;margin:0 auto;padding:0 20px}

    /* ===== Intro ===== */
    .intro{position:fixed;inset:0;background:#000;display:grid;place-items:center;z-index:9999}
    .intro__logo{width:min(92vw,1100px);opacity:0;transform:translateY(20px) scale(.96);filter:drop-shadow(0 10px 30px rgba(0,0,0,.6));animation:introIn 1600ms ease forwards 200ms}
    @keyframes introIn{to{opacity:1;transform:translateY(0) scale(1)}}
    .intro.is-hide{opacity:0;transition:opacity 1200ms ease}
    .intro.is-gone{display:none}
    .intro__logo-wrap{position:relative;display:inline-block;line-height:0;filter:drop-shadow(0 10px 30px rgba(0,0,0,.6))}
    .intro .bh{position:absolute;width:24px;height:24px;pointer-events:none;opacity:0;transform:scale(.4) rotate(0deg);z-index:10;
      background:
        radial-gradient(circle at 50% 50%, rgba(255,255,255,.22) 0%, rgba(255,255,255,.08) 22%, rgba(0,0,0,0) 38%),
        radial-gradient(circle at 50% 50%, rgba(0,0,0,.95) 16%, rgba(0,0,0,.85) 26%, rgba(90,90,90,.18) 40%, rgba(0,0,0,0) 60%),
        radial-gradient(circle at 60% 60%, rgba(255,40,20,.28), transparent 30%);
      border-radius:50%;box-shadow:inset 0 0 6px rgba(0,0,0,.9),0 0 0 1px rgba(255,255,255,.05);animation:bh-in 420ms cubic-bezier(.2,.7,.2,1) forwards}
    @keyframes bh-in{to{opacity:1;transform:scale(1) rotate(var(--rot,0deg))}}
    .intro .bh-smoke{position:absolute;width:140px;height:140px;pointer-events:none;z-index:9;background:radial-gradient(ellipse at 40% 60%, rgba(255,255,255,.10), transparent 60%);filter:blur(5px);opacity:0;transform:translate(-50%,-50%);animation:smoke 1200ms ease forwards}
    @keyframes smoke{20%{opacity:.4}100%{opacity:0;transform:translate(-50%,-50%) scale(1.3)}}

    /* ===== Global vibe ===== */
    body::before{content:"";position:fixed;inset:0;pointer-events:none;z-index:1;opacity:.22;
      background:radial-gradient(1200px 600px at 50% 40%, rgba(255,255,255,.05), transparent 60%),
                 radial-gradient(1000px 500px at 50% 130%, rgba(229,9,20,.08), transparent 60%);
      mix-blend-mode:screen}
    body::after{content:"";position:fixed;inset:0;pointer-events:none;z-index:1;background:radial-gradient(ellipse at center, transparent 60%, rgba(0,0,0,.75))}

    /* ===== Header ===== */
    .site-header{position:relative;min-height:100svh;display:grid;place-items:center;background:#000}
    .site-header__inner{position:relative;z-index:2;text-align:center}
    .subtitle{font-size:clamp(14px,2.2vw,22px);color:var(--ink);letter-spacing:.35em;margin-top:6px}

    /* ===== GNav ===== */
    .gnav{position:fixed;top:0;left:0;right:0;z-index:50;backdrop-filter:saturate(140%) blur(8px);background:rgba(8,8,12,.45);border-bottom:1px solid rgba(255,255,255,.08)}
    .gmenu{display:flex;gap:18px;align-items:center;justify-content:center;padding:14px 16px;flex-wrap:wrap}
    .gmenu a{font-weight:700;font-size:14px;letter-spacing:.12em;opacity:.9;padding:8px 10px;border-radius:999px}
    .gmenu a:hover,.gmenu a:focus{background:rgba(255,255,255,.08)}
    .gmenu .brand{margin-right:auto;font-weight:900;letter-spacing:.18em}

    /* ===== Sections ===== */
    section{position:relative;z-index:2;padding:72px 0;border-top:1px solid var(--line);background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,0))}
    section:nth-of-type(even){background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,0))}
    .sec__hd{display:flex;align-items:center;gap:14px;margin:0 0 26px}
    .sec__hd .bar{width:28px;height:2px;background:var(--accent)}
    .sec__title{font-size:clamp(18px,2.6vw,24px);letter-spacing:.18em}
    .lead{color:var(--ink);line-height:1.9}

    /* ===== News/Story/Cast… ===== */
    .news{display:grid;gap:14px}
    .news li{list-style:none;border:1px solid var(--line);background:rgba(255,255,255,.02);border-radius:12px;padding:16px;display:grid;grid-template-columns:120px 1fr;gap:12px;align-items:center}
    .news time{font-weight:700;letter-spacing:.1em;opacity:.9}
    .story{display:grid;gap:22px}
    .story .kv{border-radius:14px;overflow:hidden;border:1px solid var(--line)}
    .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    .card{border:1px solid var(--line);background:rgba(255,255,255,.02);border-radius:14px;overflow:hidden}
    .card .ph{aspect-ratio:16/9;background:#0d0d14;display:grid;place-items:center}
    .card .bd{padding:12px 14px}
    .meta{font-size:12px;letter-spacing:.18em;color:var(--ink)}

    /* Staff */
    .credit{list-style:none;margin:0;padding:0;display:grid;gap:10px}
    .credit li{display:flex;gap:12px;align-items:baseline;border:1px solid var(--line);background:rgba(255,255,255,.02);border-radius:12px;padding:12px}
    .credit .role{width:16em;min-width:10em;letter-spacing:.18em;color:var(--ink)}

    /* Gallery */
    .hscroll{display:grid;gap:14px;grid-auto-flow:column;grid-auto-columns:minmax(72vw,460px);overflow-x:auto;padding-bottom:6px;scroll-snap-type:x mandatory}
    .hscroll>*{scroll-snap-align:start;border:1px solid var(--line);border-radius:14px;overflow:hidden;background:#0d0d14}

    /* Audio */
    .audio-wrap{display:grid;gap:16px}
    .audio-player{border:1px solid var(--line);background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));border-radius:14px;padding:18px}
    .audio-player h3{margin:0 0 6px;letter-spacing:.18em}
    audio{width:100%}
    .cta{display:inline-grid;place-items:center;padding:10px 18px;border-radius:999px;border:1px solid rgba(255,255,255,.2);background:linear-gradient(180deg,rgba(229,9,20,.95),rgba(229,9,20,.75));font-weight:900;letter-spacing:.12em}

    /* Footer */
    footer{border-top:1px solid var(--line);padding:28px 0 60px;color:var(--ink);text-align:center;position:relative;z-index:2}
    .socials{display:flex;gap:16px;justify-content:center;margin:4px 0 12px}
    .socials a{display:inline-grid;place-items:center;width:48px;height:48px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid var(--line)}
    .socials a:hover{background:rgba(255,255,255,.12)}
    .socials svg{width:22px;height:22px;fill:#fff}

    /* Reveal & Bullet Holes (共通) */
    .reveal{opacity:0;transform:translateY(18px);transition:opacity 700ms ease,transform 700ms ease}
    .reveal.is-in{opacity:1;transform:none}
    .bh{position:fixed;width:22px;height:22px;pointer-events:none;opacity:0;transform:scale(.4) rotate(0deg);
      background:
        radial-gradient(circle at 50% 50%, rgba(0,0,0,1) 20%, rgba(0,0,0,.9) 26%, rgba(120,120,120,.15) 40%, rgba(0,0,0,0) 60%),
        radial-gradient(circle at 60% 60%, rgba(255,0,0,.35), transparent 30%);
      border-radius:50%;filter:drop-shadow(0 2px 2px rgba(0,0,0,.6));
      box-shadow: inset 0 0 6px rgba(0,0,0,.9), 0 0 0 1px rgba(255,255,255,.05);
      z-index:40;animation:bh-in 420ms cubic-bezier(.2,.7,.2,1) forwards}
    .bh-smoke{position:fixed;width:120px;height:120px;pointer-events:none;background:radial-gradient(ellipse at 40% 60%, rgba(255,255,255,.08), transparent 60%);filter:blur(4px);opacity:0;transform:translate(-50%,-50%);z-index:39;animation:smoke 1200ms ease forwards}

    @media (prefers-reduced-motion:reduce){.intro__logo{animation:none;opacity:1;transform:none}.reveal{transition:none;opacity:1;transform:none}}

    /* ===== Hero（左右2カラム＋下段プロフィール） ===== */
    .hero-showcase{display:grid;grid-template-columns:minmax(280px,1.1fr) minmax(240px,1fr);
      grid-template-areas:"quote img" "meta img";align-items:center;gap:28px 40px;min-height:clamp(520px,80svh,860px)}
    .quote-area{grid-area:quote;align-self:end}
    #quote-text{font-size:clamp(28px,5.8vw,64px);line-height:1.18;letter-spacing:.08em;font-weight:800;text-shadow:0 0 14px rgba(229,9,20,.45)}
    .char-info{display:contents}
    .char-img{grid-area:img;justify-self:center;width:min(64vw,640px);max-height:min(78svh,760px);object-fit:cover;border:none;border-radius:16px;box-shadow:0 18px 60px rgba(0,0,0,.55)}
    .char-meta{grid-area:meta;align-self:start;max-width:58ch}
    .char-name{font-size:clamp(20px,2.6vw,30px);margin:4px 0 4px;font-weight:900}
    .char-cv{margin:0 0 10px;font-size:14px;color:var(--ink);letter-spacing:.06em}
    .char-desc{font-size:15px;line-height:1.8;color:#ddd}
    .site-header__inner.wrap{padding-top:60px;padding-bottom:40px}

    /* スマホでも左テキスト/右画像 */
    @media (max-width:768px){
      .hero-showcase{grid-template-columns:1fr 1fr;grid-template-areas:"quote img" "meta img";gap:12px 12px;min-height:72svh}
      #quote-text{font-size:clamp(18px,6.4vw,28px);line-height:1.24}
      .char-img{width:46vw;max-height:58svh;border-radius:14px;box-shadow:0 12px 36px rgba(0,0,0,.5)}
      .char-meta{max-width:unset}
    }

    /* Mobile nav fix */
    @media (max-width:768px){
      .gmenu{justify-content:flex-start;gap:10px;padding:10px 12px;flex-wrap:nowrap;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none}
      .gmenu::-webkit-scrollbar{display:none}
      .gmenu a{font-size:13px;letter-spacing:.08em;padding:8px 10px;white-space:nowrap;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08)}
      .gmenu a:hover,.gmenu a:focus{background:rgba(255,255,255,.12)}
      .gmenu .brand{margin-right:0;position:sticky;left:0;z-index:1;background:rgba(255,255,255,.10)}
      html{scroll-padding-top:56px}
    }

    /* CAST grid center (PC/Tablet) */
    @media (min-width:768px){
      #cast .grid{grid-template-columns:repeat(auto-fit,minmax(220px,260px));justify-content:center}
      #cast .card{width:260px}
    }
  </style>
</head>
<body>
  <!-- Intro -->
  <div id="intro" class="intro">
    <div class="intro__logo-wrap">
      <!-- 参考画像を assets/intro-waver3.png に置く -->
      <img class="intro__logo" src="assets/intro-waver3.png" alt="WAVER 3">
    </div>
  </div>

  <!-- GNav + Embers Canvas -->
  <nav class="gnav">
    <div class="wrap gmenu">
      <a href="#top" class="brand">WAVER 3</a>
      <a href="#news">NEWS</a>
      <a href="#story">STORY</a>
      <a href="#cast">CAST</a>
      <a href="#staff">STAFF</a>
      <a href="#gallery">GALLERY</a>
      <a href="#audio">WAVER2（音声）</a>
    </div>
  </nav>
  <canvas id="fx-embers" aria-hidden="true"></canvas>

  <!-- Header -->
  <header id="top" class="site-header" role="banner" aria-label="メインビジュアル">
    <div class="site-header__inner wrap">
      <div class="hero-showcase">
        <div class="quote-area">
          <p class="quote-text swap-fade" id="quote-text">―― 名言がここに流れます ――</p>
        </div>
        <div class="char-info" id="char-info">
          <img class="char-img swap-fade" src="assets/char-1.jpg" alt="キャラ1">
          <div class="char-meta">
            <h3 class="char-name">キャラ名1</h3>
            <p class="char-cv">CV. 演者名1</p>
            <p class="char-desc">キャラの設定詳細をここに記載します。性格や役割など。</p>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- NEWS -->
  <section id="news">
    <div class="wrap">
      <div class="sec__hd reveal bh-target"><span class="bar"></span><h2 class="sec__title">NEWS</h2></div>
      <ul class="news">
        <li class="reveal"><time datetime="2025-09-01">2025.09.01</time><div>特設サイト公開。ティザービジュアルを解禁しました。</div></li>
        <li class="reveal"><time datetime="2025-09-05">2025.09.05</time><div>キービジュアル第2弾を公開予定。</div></li>
        <li class="reveal"><time datetime="2025-09-20">2025.09.20</time><div><a href="#audio">「WAVER2（音声版）」</a>の期間限定公開が決定。</div></li>
      </ul>
    </div>
  </section>

  <!-- STORY -->
  <section id="story">
    <div class="wrap">
      <div class="sec__hd reveal bh-target"><span class="bar"></span><h2 class="sec__title">STORY</h2></div>
      <div class="story">
        <figure class="kv reveal"><img src="assets/story.jpg" alt="ストーリーイメージ"></figure>
        <p class="lead reveal">都市の闇に蠢く“波動”は、すでに臨界を超えていた──。<br>伝説の作戦名〈WAVER〉が再起動する。生還率はゼロに等しい。それでも、選ぶのは“生か死”ではなく“進むか止まるか”。</p>
      </div>
    </div>
  </section>

  <!-- CAST -->
  <section id="cast">
    <div class="wrap">
      <div class="sec__hd reveal bh-target"><span class="bar"></span><h2 class="sec__title">CAST</h2></div>
      <div class="grid">
        <!-- ダミー -->
        <article class="card reveal"><div class="ph"><img src="assets/cast-1.jpg" alt="キャスト1" loading="lazy"></div><div class="bd"><strong>キャスト1</strong><div class="meta">Cast</div></div></article>
        <article class="card reveal"><div class="ph"><img src="assets/cast-2.jpg" alt="キャスト2" loading="lazy"></div><div class="bd"><strong>キャスト2</strong><div class="meta">Cast</div></div></article>
        <article class="card reveal"><div class="ph"><img src="assets/cast-3.jpg" alt="キャスト3" loading="lazy"></div><div class="bd"><strong>キャスト3</strong><div class="meta">Cast</div></div></article>
        <article class="card reveal"><div class="ph"><img src="assets/cast-4.jpg" alt="キャスト4" loading="lazy"></div><div class="bd"><strong>キャスト4</strong><div class="meta">Cast</div></div></article>
        <article class="card reveal"><div class="ph"><img src="assets/cast-5.jpg" alt="キャスト5" loading="lazy"></div><div class="bd"><strong>キャスト5</strong><div class="meta">Cast</div></div></article>
      </div>
    </div>
  </section>

  <!-- STAFF -->
  <section id="staff">
    <div class="wrap">
      <div class="sec__hd reveal bh-target"><span class="bar"></span><h2 class="sec__title">STAFF</h2></div>
      <ul class="credit">
        <li class="reveal"><strong class="role">監督</strong><span>Chama</span></li>
        <li class="reveal"><strong class="role">監修</strong><span>Suzuki</span></li>
        <li class="reveal"><strong class="role">脚本</strong><span>Chama</span></li>
        <li class="reveal"><strong class="role">制作</strong><span>Suzuki</span></li>
        <li class="reveal"><strong class="role">キャラクターデザイン／総作画監督</strong><span>Chama</span></li>
      </ul>
    </div>
  </section>

  <!-- GALLERY -->
  <section id="gallery">
    <div class="wrap">
      <div class="sec__hd reveal bh-target"><span class="bar"></span><h2 class="sec__title">GALLERY</h2></div>
      <div class="hscroll">
        <img class="reveal" src="assets/gal-1.jpg" alt="ギャラリー1" loading="lazy">
        <img class="reveal" src="assets/gal-2.jpg" alt="ギャラリー2" loading="lazy">
        <img class="reveal" src="assets/gal-3.jpg" alt="ギャラリー3" loading="lazy">
        <img class="reveal" src="assets/gal-4.jpg" alt="ギャラリー4" loading="lazy">
      </div>
    </div>
  </section>

  <!-- AUDIO -->
  <section id="audio">
    <div class="wrap">
      <div class="sec__hd reveal bh-target"><span class="bar"></span><h2 class="sec__title">WAVER2 はこちらから</h2></div>
      <div class="audio-wrap">
        <div class="audio-player reveal">
          <h3>WAVER2 サウンドエディション</h3>
          <audio controls preload="metadata">
            <source src="assets/waver2.mp3" type="audio/mpeg" />
            <source src="assets/waver2.ogg" type="audio/ogg" />
            お使いのブラウザは audio タグに対応していません。
          </audio>
        </div>
        <a class="cta reveal" href="assets/waver2.mp3" download>音声をダウンロード</a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="wrap">
      <div class="socials">
        <a href="#" aria-label="X" title="X"><svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 3h4l5 7 5-7h4l-7.5 10L22 21h-4l-6-8-6 8H2l7.6-10L3 3z"/></svg></a>
        <a href="#" aria-label="Instagram" title="Instagram"><svg viewBox="0 0 24 24" aria-hidden="true"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 5.5A5.5 5.5 0 1 1 6.5 13 5.5 5.5 0 0 1 12 7.5zM18.75 5.25a1.25 1.25 0 1 1-1.25 1.25 1.25 1.25 0 0 1 1.25-1.25z"/></svg></a>
        <a href="#" aria-label="WAVE" title="WAVE"><svg viewBox="0 0 64 24" aria-hidden="true"><path d="M2 2h12l6 14 6-14h12l-7 20H42L32 8l-10 14H9z" fill="white"/></svg></a>
      </div>
      © 2025 WAVER PROJECT. All Rights Reserved.
    </div>
  </footer>

  <!-- ===== Script 1: Intro（フェードイン→連射→フェードアウト） ===== -->
  <script>
  const introEl  = document.getElementById('intro');
  const logoEl   = document.querySelector('.intro__logo');
  let introDone  = false;

  function hideIntroOnce(){
    if (introDone || !introEl) return;
    introDone = true;
    introEl.classList.add('is-hide');
    setTimeout(()=> introEl.classList.add('is-gone'), 1200);
  }

  function shootLogo(target, opts={}){
    const wrap = target?.closest('.intro__logo-wrap');
    if(!wrap) return hideIntroOnce();

    const rect = target.getBoundingClientRect();
    const count    = opts.count ?? 18;
    const spread   = opts.spread ?? 0.85;
    const interval = opts.interval ?? 80;
    let i = 0;

    function hit(){
      const rx = (Math.random()-0.5)*2;
      const ry = (Math.random()-0.5)*2;
      const bx = rect.width  * 0.5 + rx * rect.width  * spread * 0.5;
      const by = rect.height * 0.45+ ry * rect.height * spread * 0.45;

      const hole = document.createElement('div');
      hole.className = 'bh';
      hole.style.left = (bx - 12) + 'px';
      hole.style.top  = (by - 12) + 'px';
      hole.style.setProperty('--rot',(Math.random()*60-30)+'deg');
      wrap.appendChild(hole);

      const smoke = document.createElement('div');
      smoke.className = 'bh-smoke';
      smoke.style.left = bx + 'px';
      smoke.style.top  = by + 'px';
      wrap.appendChild(smoke);
      setTimeout(()=> smoke.remove(), 1400);

      i++;
      if(i < count){ setTimeout(hit, interval); }
      else { setTimeout(hideIntroOnce, 600); }
    }
    hit();
  }

  function startIntro(){
    document.getElementById('quote-text')?.classList.add('is-show');
    document.getElementById('char-info')?.classList.add('is-show');
    setTimeout(() => shootLogo(logoEl, { count: 18, spread: 0.85, interval: 80 }), 1400);
  }

  window.addEventListener('load', () => {
    if (logoEl?.complete) startIntro();
    else logoEl?.addEventListener('load', startIntro, { once:true });
  });

  ['click','wheel','touchstart','keydown'].forEach(ev =>
    window.addEventListener(ev, hideIntroOnce, {passive:true})
  );

  setTimeout(hideIntroOnce, 8000);
  </script>

  <!-- ===== Script 2: 残りの演出＆機能 ===== -->
  <script>
  // Reveal on scroll + bullet holes trigger
  const io = new IntersectionObserver((ents)=>{
    ents.forEach(e=>{
      if(e.isIntersecting){
        e.target.classList.add('is-in');
        io.unobserve(e.target);
        if(e.target.classList.contains('bh-target')) sprinkleHoles(e.target);
      }
    });
  },{threshold:.08});
  document.querySelectorAll('.reveal,.bh-target').forEach(el=>io.observe(el));

  // Smooth scroll
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click', (e)=>{
      const id=a.getAttribute('href');
      if(id.length>1){ e.preventDefault(); document.querySelector(id)?.scrollIntoView({behavior:'smooth'}); }
    });
  });

  // Light parallax header
  const header=document.querySelector('.site-header');
  window.addEventListener('scroll', ()=>{
    const y=Math.min(1,scrollY/innerHeight);
    header.style.transform=`translateY(${y*12}px)`;
    header.style.filter=`saturate(${1-y*0.2})`;
  },{passive:true});

  // Bullet holes generator (共通)
  function sprinkleHoles(target, opts){
    const rect = target.getBoundingClientRect();
    const baseX = rect.left + rect.width/2 + window.scrollX;
    const baseY = rect.top + rect.height/2 + window.scrollY;
    const isImg = target.tagName === 'IMG';
    const count = (typeof opts === 'number') ? opts : (opts && typeof opts.count === 'number') ? opts.count : (isImg ? 12 : 4);
    const radiusFactor = (opts && typeof opts.radius === 'number') ? opts.radius : (isImg ? 0.42 : 0.35);
    const makeSmoke = (opts && opts.smoke === false) ? false : true;
    for(let i=0;i<count;i++){
      const ang=(Math.random()*Math.PI*2);
      const r=Math.random()*rect.width*radiusFactor;
      const x= baseX + Math.cos(ang)*r;
      const y= baseY + Math.sin(ang)*Math.max(10,rect.height*0.55);
      const hole=document.createElement('div');
      hole.className='bh';
      hole.style.left=(x-11)+'px';
      hole.style.top=(y-11)+'px';
      hole.style.setProperty('--rot',(Math.random()*60-30)+'deg');
      document.body.appendChild(hole);
      if(makeSmoke){
        const smoke=document.createElement('div');
        smoke.className='bh-smoke'; smoke.style.left=x+'px'; smoke.style.top=y+'px'; document.body.appendChild(smoke);
        setTimeout(()=> smoke.remove(), 1400);
      }
    }
  }

  // Embers FX (site-wide)
  (function(){
    const c = document.getElementById('fx-embers');
    if(!c) return; const dpr = Math.min(2, window.devicePixelRatio||1);
    const ctx = c.getContext('2d'); let W, H, parts=[]; const MAX=90;
    function resize(){ W = c.width = innerWidth * dpr; H = c.height = innerHeight * dpr; c.style.width = innerWidth+'px'; c.style.height = innerHeight+'px'; }
    function spawn(){ if(parts.length>MAX) return; parts.push({ x: Math.random()*W, y: H + Math.random()*H*.2, vx:(Math.random()-.5)*.08*dpr, vy: -(1+Math.random()*1.5)*dpr, life: 80+Math.random()*120, r: 1.2*dpr+Math.random()*1.6*dpr }); }
    function tick(){ ctx.clearRect(0,0,W,H);
      const g = ctx.createRadialGradient(W*.5,H*.45,0,W*.5,H*.45,Math.max(W,H)*.7);
      g.addColorStop(0,'rgba(255,255,255,0.01)'); g.addColorStop(1,'rgba(0,0,0,0.0)');
      ctx.fillStyle=g; ctx.fillRect(0,0,W,H);
      for(let i=0;i<3;i++) spawn();
      for(let i=parts.length-1;i>=0;i--){ const p=parts[i]; p.x+=p.vx; p.y+=p.vy; p.life--; const f=Math.max(0,Math.min(1,p.life/140));
        ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fillStyle=`rgba(255,120,20,${0.25*f})`; ctx.fill();
        ctx.beginPath(); ctx.arc(p.x,p.y,p.r*.5,0,Math.PI*2); ctx.fillStyle=`rgba(255,200,120,${0.35*f})`; ctx.fill();
        if(p.life<=0||p.y<-20*dpr) parts.splice(i,1);
      }
      requestAnimationFrame(tick);
    }
    resize(); tick(); window.addEventListener('resize', resize);
  })();

  // ===== Character Quotes Rotator =====
  const quotes = [
    {quote:"この物語の主人公は俺らだからよ─", img:"assets/char-1.jpg", name:"ちゃま", cv:"chama", desc:"熱しやすく冷めやすい。背中で語る姿はまさにKING"},
    {quote:"皆となら負ける気はしません─", img:"assets/char-2.jpg", name:"珠来", cv:"Suzuki", desc:"随一の忠誠心。冷静で分析上手なまとめ役"},
    {quote:"上等。全員消しといてやるよ─", img:"assets/char-3.jpg", name:"るみみん", cv:"neki", desc:"すぐキレるが仲間思い。最強のリードオフマン"}
  ];
  let qIndex = 0;
  function showQuote(i){
    const q = quotes[i];
    const qt = document.getElementById('quote-text');
    const imgEl = document.querySelector('#char-info .char-img');
    const nameEl = document.querySelector('#char-info .char-name');
    const cvEl = document.querySelector('#char-info .char-cv');
    const descEl = document.querySelector('#char-info .char-desc');

    qt.classList.add('swap-hide');
    imgEl.classList.add('swap-hide');

    const pre = new Image();
    pre.onload = apply; pre.onerror = apply; pre.src = q.img;

    function apply(){
      setTimeout(()=>{
        qt.textContent = q.quote;
        nameEl.textContent = q.name;
        cvEl.textContent = 'CV.' + q.cv;
        descEl.textContent = q.desc;
        if(imgEl.src !== q.img) imgEl.src = q.img;
        requestAnimationFrame(()=>{
          qt.classList.remove('swap-hide');
          imgEl.classList.remove('swap-hide');
          try { sprinkleHoles(qt, {count: 1 + Math.floor(Math.random()*2), radius: 0.22}); } catch(e){}
        });
      }, 180);
    }
  }
  function rotateQuotes(){ showQuote(qIndex); qIndex=(qIndex+1)%quotes.length; setTimeout(rotateQuotes,5000); }
  if(quotes.length>0) rotateQuotes();
  </script>
</body>
</html>
